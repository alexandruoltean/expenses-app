<div class="dialog-container">
  <h2 mat-dialog-title>Add New Expense</h2>
  
  <div mat-dialog-content>
    <form [formGroup]="expenseForm" (ngSubmit)="onSubmit()" class="expense-form">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Title</mat-label>
        <input matInput 
               formControlName="title" 
               placeholder="Enter expense title">
        <mat-error *ngIf="expenseForm.get('title')?.hasError('required')">
          Title is required
        </mat-error>
        <mat-error *ngIf="expenseForm.get('title')?.hasError('maxlength')">
          Title cannot exceed 100 characters
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Amount</mat-label>
        <input matInput 
               type="number" 
               formControlName="amount" 
               placeholder="0.00" 
               step="0.01" 
               min="0">
        <span matPrefix>$&nbsp;</span>
        <mat-error *ngIf="expenseForm.get('amount')?.hasError('required')">
          Amount is required
        </mat-error>
        <mat-error *ngIf="expenseForm.get('amount')?.hasError('min')">
          Amount must be greater than 0
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Category</mat-label>
        <mat-select formControlName="category">
          <mat-option *ngFor="let category of categories" [value]="category">
            {{category}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="expenseForm.get('category')?.hasError('required')">
          Category is required
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Date</mat-label>
        <input matInput 
               [matDatepicker]="picker" 
               formControlName="date">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        <mat-error *ngIf="expenseForm.get('date')?.hasError('required')">
          Date is required
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description (Optional)</mat-label>
        <textarea matInput 
                  formControlName="description" 
                  placeholder="Enter expense description"
                  rows="3"></textarea>
        <mat-error *ngIf="expenseForm.get('description')?.hasError('maxlength')">
          Description cannot exceed 500 characters
        </mat-error>
      </mat-form-field>
    </form>
  </div>

  <div mat-dialog-actions align="end">
    <button mat-button 
            type="button" 
            [mat-dialog-close]="false">
      Cancel
    </button>
    <button mat-raised-button 
            color="primary" 
            type="submit" 
            [disabled]="expenseForm.invalid || loading"
            (click)="onSubmit()">
      <mat-icon *ngIf="loading">hourglass_empty</mat-icon>
      <mat-icon *ngIf="!loading">add</mat-icon>
      {{loading ? 'Adding...' : 'Add Expense'}}
    </button>
  </div>
</div>