<div class="dashboard-container">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1><mat-icon>dashboard</mat-icon> Expense Dashboard</h1>
      <p class="subtitle">Track and analyze your spending patterns</p>
    </div>
  </div>

  <div *ngIf="loading" class="loading-state">
    <mat-card>
      <mat-card-content>
        <div class="loading-content">
          <mat-icon class="loading-icon">hourglass_empty</mat-icon>
          <p>Loading your expense data...</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <div *ngIf="!loading && filteredExpenses.length === 0" class="empty-dashboard">
    <mat-card class="empty-card">
      <mat-card-content>
        <div class="empty-state">
          <mat-icon class="empty-icon">receipt_long</mat-icon>
          <h2>Welcome to Your Expense Dashboard</h2>
          <p>Start tracking your expenses to see insights and analytics</p>
<p class="help-text">Use the "Add Expense" button in the top toolbar to get started</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <div *ngIf="!loading && filteredExpenses.length > 0" class="dashboard-content">
    <!-- Stats Cards Row -->
    <div class="stats-row">
      <mat-card class="stat-card total-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon>account_balance_wallet</mat-icon>
            </div>
            <div class="stat-details">
              <h3>Total Spent</h3>
              <p class="stat-value">${{getTotalAmount() | number:'1.2-2'}}</p>
              <span class="stat-period">This Month</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card expenses-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon>receipt</mat-icon>
            </div>
            <div class="stat-details">
              <h3>Total Expenses</h3>
              <p class="stat-value">{{filteredExpenses.length}}</p>
              <span class="stat-period">Transactions</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card avg-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon>trending_up</mat-icon>
            </div>
            <div class="stat-details">
              <h3>Average</h3>
              <p class="stat-value">${{getAverageAmount() | number:'1.2-2'}}</p>
              <span class="stat-period">Per Transaction</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card category-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon>category</mat-icon>
            </div>
            <div class="stat-details">
              <h3>Top Category</h3>
              <p class="stat-value">{{getTopCategory()}}</p>
              <span class="stat-period">Most Spent</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Charts and Analysis Row -->
    <div class="charts-row">
      <mat-card class="chart-card category-breakdown">
        <mat-card-header>
          <mat-card-title><mat-icon>pie_chart</mat-icon> Spending by Category</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="category-chart">
            <div *ngFor="let category of getCategoryBreakdown()" class="category-item">
              <div class="category-info">
                <span class="category-name">{{category.name}}</span>
                <span class="category-amount">${{category.amount | number:'1.2-2'}}</span>
              </div>
              <div class="category-bar">
                <div class="bar-fill" [style.width.%]="category.percentage"></div>
              </div>
              <span class="category-percent">{{category.percentage | number:'1.1-1'}}%</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Daily Expenses Graph - Chart.js -->
      <mat-card class="chart-card daily-expenses-chart">
        <mat-card-header>
          <mat-card-title><mat-icon>trending_up</mat-icon> 7-Day Trend</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-summary">
            <div class="trend-info">
              <span class="trend-label">This Week</span>
              <span class="trend-value">${{getWeekTotal() | number:'1.0-0'}}</span>
            </div>
            <div class="trend-change" [class.positive]="getTrendDirection() > 0" [class.negative]="getTrendDirection() < 0">
              <mat-icon>{{getTrendDirection() > 0 ? 'trending_up' : getTrendDirection() < 0 ? 'trending_down' : 'trending_flat'}}</mat-icon>
              <span>{{getTrendDirection() === 0 ? 'Stable' : (getTrendDirection() > 0 ? '+' : '') + getTrendDirection().toFixed(1) + '%'}}</span>
            </div>
          </div>
          
          <div class="chart-container">
            <canvas
              baseChart
              [data]="lineChartData"
              [options]="lineChartOptions"
              [type]="lineChartType">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="chart-card recent-activity">
        <mat-card-header>
          <mat-card-title><mat-icon>history</mat-icon> Recent Activity</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="activity-list">
            <div *ngFor="let expense of getRecentExpenses()" class="activity-item">
              <div class="activity-icon">
                <mat-icon>{{getCategoryIcon(expense.category)}}</mat-icon>
              </div>
              <div class="activity-details">
                <h4>{{expense.title}}</h4>
                <p>{{expense.category}} â€¢ {{expense.date | date:'MMM d'}}</p>
              </div>
              <div class="activity-amount">
                ${{expense.amount | number:'1.2-2'}}
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Detailed Expense List -->
    <div class="expense-list-section">
      <mat-card class="expense-list-card">
        <mat-card-header>
          <mat-card-title><mat-icon>list</mat-icon> All Expenses</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="expense-table">
            <div *ngFor="let expense of filteredExpenses" class="expense-row">
              <div class="expense-info">
                <div class="expense-primary">
                  <h4>{{expense.title}}</h4>
                  <mat-chip class="category-chip">{{expense.category}}</mat-chip>
                </div>
                <div class="expense-secondary">
                  <span class="expense-date">{{expense.date | date:'MMM d, y'}}</span>
                  <span *ngIf="expense.description" class="expense-desc">{{expense.description}}</span>
                </div>
              </div>
              <div class="expense-amount">
                <span class="amount-value">${{expense.amount | number:'1.2-2'}}</span>
              </div>
              <div class="expense-actions">
                <button mat-icon-button (click)="openEditExpenseDialog(expense)" color="primary">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button (click)="deleteExpense(expense.id!)" color="warn">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>